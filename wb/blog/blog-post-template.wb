{"type":"div","style":{"margin":"0px","padding":"0px","display":"flex","flexDirection":"column","minHeight":"100vh","direction":"rtl"},"on":{"init":"$window.scrollTo(0,0); // move scroll to top of the page\n"},"version":"wb4","children":[{"style":{},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/scripts/content#script-libs","id":"import-scripts"},{"style":{},"type":"style","children":[],"on":{},"version":"wb4","text":"body, h1, h2, h3, h4, h5, h6 {\n\tfont-family: Gandom, BKoodakBold, Roboto, \"Helvetica Neue\", sans-serif;\n}\n\nimg {\n    max-width: 100%;\n}\n\nbody {\n    font-size: 15px;\n}\nh1, h2, h3, h4, h5, h6{\n    font-weight: bold;\n    line-height: 1.9;\n}\nh1{font-size:28px} \nh2{font-size:24px} \nh3{font-size:20px} \nh4{font-size:18px} \nh5{font-size:16px} \nh6{font-size:14px}\np {\n    font-size: 16px;\n    line-height: 1.9;\n}\nli {\n    font-size: 16px;\n    line-height: 1.8;\n}"},{"style":{},"type":"style","children":[],"on":{},"version":"wb4","text":".main-content p{\n\ttext-align: justify;\n\t\n}\n\n.main-content img {\n    max-width: 90%;\n    margin: auto;\n}\n\n.main-content figure {\n    max-width: 100%;\n    margin: auto;\n    text-align: center;\n}\n\nfigure > image {\n    margin: 0px\n    padding: 0px\n    width:100%\n}","id":"style-main-content"},{"style":{"minHeight":"80px"},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/blog-widgets/content#main-toolbar","id":"import-toolbar"},{"style":{"maxWidth":"1100px","flexDirection":"column","minWidth":"200px","display":"flex"},"type":"div","class":"w3-content","children":[{"style":{"display":"flex","flexDirection":"column"},"type":"div","class":"w3-container","children":[{"style":{"objectFit":"cover","objectPosition":"center top","maxHeight":"250px","height":"250px","minHeight":"250px","maxWidth":"100%"},"type":"img","alt":"{{title}}","html":"","on":{},"version":"wb4","id":"image"},{"name":"Header-1","style":{"padding":"8px","paddingTop":"8px","paddingRight":"8px","paddingBottom":"8px","paddingLeft":"8px","position":"relative","textAlign":"center"},"type":"h1","on":{},"version":"wb4","id":"title","html":"قالب پست‌های بلاگ"}],"on":{},"id":"div-header","version":"wb4"},{"style":{"margin":"0px 16px","align":{},"alignSelf":"stretch","display":"flex","flexDirection":"column","flexWrap":"no-wrap","justifyContent":"center","alignItems":"stretch","backgroundColor":"rgb(255, 255, 255)","borderStyle":"solid","borderColor":"#dadada","borderWidth":"2px 2px 2px 2px","borderRadius":"4px 4px 4px 4px","marginTop":"0px","marginRight":"16px","marginBottom":"0px","marginLeft":"16px","borderTopStyle":"solid","borderRightStyle":"solid","borderBottomStyle":"solid","borderLeftStyle":"solid","borderTopColor":"rgb(218, 218, 218)","borderRightColor":"rgb(218, 218, 218)","borderBottomColor":"rgb(218, 218, 218)","borderLeftColor":"rgb(218, 218, 218)","borderTopWidth":"2px","borderRightWidth":"2px","borderBottomWidth":"2px","borderLeftWidth":"2px","borderTopLeftRadius":"4px","borderTopRightRadius":"4px","borderBottomRightRadius":"4px","borderBottomLeftRadius":"4px","padding":"16px","paddingTop":"16px","paddingRight":"16px","paddingBottom":"16px","paddingLeft":"16px"},"type":"div","name":"div","on":{},"children":[{"style":{"margin":"1px","align":{},"padding":"8px 12px 8px 12px","alignSelf":"stretch","display":"flex","flexDirection":"column","flexWrap":"no-wrap","justifyContent":"center","alignItems":"stretch","backgroundColor":"#ffffff","borderStyle":"solid","borderColor":"#dadada","borderWidth":"2px 2px 2px 2px","borderRadius":"4px 4px 4px 4px"},"type":"div","name":"div","on":{},"children":[],"version":"wb4","id":"main-body"}],"version":"wb4","id":"div-content","class":"main-content"},{"style":{"display":"flex","flexDirection":"row","flexWrap":"wrap","justifyContent":"center"},"type":"div","class":"w3-col","children":[{"style":{"display":"flex","flexGrow":"1","flexShrink":"1","flexDirection":"row","flexBasis":"200px","backgroundColor":"white","borderColor":"#dadada","borderTopColor":"rgb(218, 218, 218)","borderRightColor":"rgb(218, 218, 218)","borderBottomColor":"rgb(218, 218, 218)","borderLeftColor":"rgb(218, 218, 218)","borderStyle":"solid","borderTopStyle":"solid","borderRightStyle":"solid","borderBottomStyle":"solid","borderLeftStyle":"solid","borderWidth":"2px","borderTopWidth":"2px","borderRightWidth":"2px","borderBottomWidth":"2px","borderLeftWidth":"2px"},"type":"div","children":[{"style":{"height":"100px","width":"100px","borderRadius":"50%","borderTopLeftRadius":"50%","borderTopRightRadius":"50%","borderBottomRightRadius":"50%","borderBottomLeftRadius":"50%"},"type":"img","html":"","on":{},"id":"avatar","version":"wb4","src":"/api/v2/cms/contents/logo/content"},{"style":{"fontSize":"larger","display":"flex","flexDirection":"column","flexGrow":"1","flexShrink":"1"},"type":"div","children":[{"style":{},"type":"span","on":{},"html":"<b>مدیر سایت</b>","id":"name","version":"wb4"},{"style":{"display":"none"},"type":"p","html":"Just me, myself and I, exploring the universe of\n\t\t\t\t\t\t\tuknownment. I have a heart of love and a interest of lorem ipsum\n\t\t\t\t\t\t\tand mauris neque quam blog. I want to share my world with you.","on":{},"id":"about","version":"wb4"}],"on":{},"id":"info","class":"w3-container","version":"wb4"}],"on":{},"id":"author","class":"w3-container w3-padding w3-margin","version":"wb4"},{"style":{"flexBasis":"200px","display":"flex","flexGrow":"1","flexShrink":"1","flexDirection":"column","borderTopWidth":"2px","borderRightWidth":"2px","borderBottomWidth":"2px","borderLeftWidth":"2px","borderTopStyle":"solid","borderRightStyle":"solid","borderBottomStyle":"solid","borderLeftStyle":"solid","borderTopColor":"rgb(218, 218, 218)","borderRightColor":"rgb(218, 218, 218)","borderBottomColor":"rgb(218, 218, 218)","borderLeftColor":"rgb(218, 218, 218)","borderImageSource":"initial","borderImageSlice":"initial","borderImageWidth":"initial","borderImageOutset":"initial","borderImageRepeat":"initial"},"type":"div","class":"w3-container w3-padding w3-white w3-margin","children":[{"style":{},"type":"div","class":"w3-container w3-padding","children":[{"style":{},"type":"h4","html":"برچسب&zwnj;ها","on":{},"version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px","flexGrow":"1","alignContent":"flex-start"},"type":"div","name":"div","on":{"init":"// Hide template\nvar tmpl = $widget.getChildById('template');\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        tmpl.setProperty('style.display');\n    }else{\n        tmpl.setProperty('style.display', 'none');\n    }\n});"},"children":[{"style":{"flexGrow":"1","display":"flex","flexWrap":"wrap","justifyContent":"flex-start","flexShrink":"1","alignContent":"flex-start"},"type":"ObjectCollection","name":"Object collection","on":{},"id":"tags","children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","padding":"4px","margin":"8px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px","paddingTop":"4px","paddingRight":"4px","paddingBottom":"4px","paddingLeft":"4px","marginTop":"8px","marginRight":"8px","marginBottom":"8px","marginLeft":"8px","textDecoration":"none","textDecorationLine":"none","textDecorationStyle":"initial","textDecorationColor":"initial"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","href":"blog/posts?ttid={{id}}","version":"wb4"}],"filters":[{"key":"taxonomy","value":"tag"}],"properties":"{items{id,taxonomy,description,count,term{name}}}","version":"wb4","template":"{\"html\":\"{{term.name}}\",\"type\":\"a\",\"name\":\"A link\",\"on\":{},\"style\":{\"borderRadius\":\"2px\",\"padding\":\"4px\",\"margin\":\"8px\",\"borderTopLeftRadius\":\"2px\",\"borderTopRightRadius\":\"2px\",\"borderBottomRightRadius\":\"2px\",\"borderBottomLeftRadius\":\"2px\",\"paddingTop\":\"4px\",\"paddingRight\":\"4px\",\"paddingBottom\":\"4px\",\"paddingLeft\":\"4px\",\"marginTop\":\"8px\",\"marginRight\":\"8px\",\"marginBottom\":\"8px\",\"marginLeft\":\"8px\",\"textDecoration\":\"none\",\"textDecorationLine\":\"none\",\"textDecorationStyle\":\"initial\",\"textDecorationColor\":\"initial\"},\"id\":\"template\",\"class\":\"w3-tag w3-light-grey w3-small w3-margin-bottom\",\"href\":\"blog/pages?ttid={{id}}\",\"version\":\"wb4\"}"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"tags","version":"wb4"}],"on":{},"id":"overview","version":"wb4"},{"style":{"overflow":"hidden"},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/blog-widgets/content#a-ads-frame","id":"import-a-ads-frame"},{"style":{},"type":"hr","name":"hr","on":{},"version":"wb4"},{"style":{"padding":"8px","paddingTop":"8px","paddingRight":"8px","paddingBottom":"8px","paddingLeft":"8px","position":"relative","textAlign":"center"},"type":"h2","on":{},"version":"wb4","name":"Header-2","html":"سایر مطالب این نویسنده","id":"other-posts-title"},{"style":{"display":"flex","flexWrap":"wrap","flexDirection":"row","justifyContent":"center","alignContent":"flex-start"},"on":{"init":"$widget.on('stateChanged', function(){\n    if($widget.state == 'edit'){\n        $widget.removeChildren();\n    }\n});"},"children":[],"class":"w3-row","id":"pages-collection","filters":[],"sorts":[],"version":"wb4","type":"div"},{"style":{"flexGrow":"1","display":"flex"},"type":"div","name":"div","on":{"init":"// Hide template\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        $widget.setProperty('style.display', 'flex');\n    }else{\n        $widget.setProperty('style.display', 'none');\n    }\n});"},"version":"wb4","children":[{"style":{"flexBasis":"300px","flexDirection":"column","display":"flex","flexShrink":"1","flexGrow":"1"},"type":"div","children":[{"style":{},"type":"meta","children":[],"on":{},"version":"wb4","id":"published","itemprop":"datePublished","content":"{{creation_dtime}}"},{"style":{},"type":"meta","children":[],"on":{},"version":"wb4","id":"modified","itemprop":"dateModified","content":"{{modif_dtime}}"},{"style":{},"type":"div","itemprop":"author","itemscope":"true","itemtype":"https://schema.org/Person","children":[{"style":{},"type":"meta","itemprop":"identifier","content":"{{author.id}}","children":[],"on":{},"version":"wb4","id":"identifier"},{"style":{},"type":"meta","itemprop":"name","content":"{{author.profiles.0.first_name}} {{author.profiles.0.last_name}} در هفت طوطی","children":[],"on":{},"version":"wb4","id":"name"},{"style":{},"type":"meta","itemprop":"familyName","content":"{{author.profiles.1.last_name}}","children":[],"on":{},"version":"wb4","id":"familyName"},{"style":{},"type":"meta","itemprop":"givenName","content":"{{author.profiles.0.first_name}}","children":[],"on":{},"version":"wb4","id":"givenName"},{"style":{},"type":"meta","itemprop":"image","content":"/api/v2/user/accounts/{{author.id}}/avatar","children":[],"on":{},"version":"wb4","id":"image"}],"on":{},"version":"wb4","id":"author"},{"style":{},"type":"div","itemprop":"publisher","itemscope":"true","itemtype":"https://schema.org/Organization","children":[{"style":{},"type":"meta","itemprop":"name","content":"هفت طوطی","on":"[object Object]","id":"name","children":[],"version":"wb4"},{"style":{},"type":"div","itemprop":"logo","itemscope":"true","itemtype":"https://schema.org/ImageObject","children":[{"style":{},"type":"meta","itemprop":"url","content":"/api/v2/cms/contents/logo/content","on":"[object Object]","id":"url","children":[],"version":"wb4"},{"style":{},"type":"meta","itemprop":"height","content":"500","on":"[object Object]","id":"height","children":[],"version":"wb4"},{"style":{},"type":"meta","itemprop":"width","content":"500","on":"[object Object]","id":"width","children":[],"version":"wb4"}],"on":{},"version":"wb4","id":"logo"}],"on":{},"version":"wb4","id":"publisher"},{"style":{"objectFit":"cover","objectPosition":"center top","height":"170px","maxWidth":"100%","maxHeight":"170px","minHeight":"170px"},"type":"img","alt":"{{title}}","html":"","on":{},"src":"/imgx{{{metamap.link_cover}}}?h=170&w=450&f=cover","version":"wb4","itemprop":"image"},{"style":{},"type":"div","class":"w3-container","children":[{"style":{"position":"relative","textDecoration":"none"},"type":"a","html":"<h3><b>{{title}}</b></h3>","on":{},"id":"title","version":"wb4","itemprop":"headline","href":"{{{metamap.link_canonical}}}"},{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{"init":"// Hide template\nvar tmpl = $widget.getChildById('template');\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        tmpl.setProperty('style.display');\n    }else{\n        tmpl.setProperty('style.display', 'none');\n    }\n});\n\n// Add tags to the list\nvar tags = {{tags}};\nvar template = $widget.getChildById('template');\nvar tagList = $widget.getChildById('tags-div');\n\nfunction addTag(tag){\n    var el = template.getModel();\n    el = angular.copy(el);\n    el.id = tag.name;\n    el.html = tag.name;\n    tagList.addChild(0, el);\n}\n\ntags.forEach(addTag);"},"children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","version":"wb4"},{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"div","on":{},"id":"tags-div","children":[],"version":"wb4"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{"flexGrow":"1"},"type":"div","class":"w3-container","children":[{"style":{"position":"relative"},"type":"p","html":"{{description}}","on":{},"id":"description","version":"wb4"}],"on":{},"id":"div-body","version":"wb4"}],"on":{},"version":"wb4","id":"blog-entry-tmpl-mobile","class":"w3-card-2 w3-white","itemscope":"true","itemtype":"https://schema.org/BlogPosting"},{"style":{"flexDirection":"row","display":"flex","flexShrink":"1","flexBasis":"500px","margin":"4px","marginTop":"4px","marginRight":"4px","marginBottom":"4px","marginLeft":"4px"},"type":"div","class":"w3-card-2 w3-white","children":[{"style":{"objectFit":"cover","objectPosition":"center top","width":"200px","maxHeight":"100%","maxWidth":"200px","minWidth":"200px"},"type":"img","alt":"{{title}}","html":"","on":{},"src":"/imgx{{{metamap.link_cover}}}?w=200&h=450&f=fill","version":"wb4"},{"style":{"display":"flex","flexDirection":"column","flexGrow":"1","flexShrink":"1","alignContent":"flex-start"},"type":"div","name":"div","on":{},"version":"wb4","children":[{"style":{"display":"flex","flexDirection":"column"},"type":"div","class":"w3-container","children":[{"name":"Header-3","style":{"padding":"8px","paddingTop":"8px","paddingRight":"8px","paddingBottom":"8px","paddingLeft":"8px","position":"relative"},"type":"h3","on":{},"version":"wb4","html":"<a href=\"{{{metamap.link_canonical}}}\" style=\"text-decoration:none;\">{{title}}</a>","id":"h3-title"},{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{"init":"// Hide template\nvar tmpl = $widget.getChildById('template');\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        tmpl.setProperty('style.display');\n    }else{\n        tmpl.setProperty('style.display', 'none');\n    }\n});\n\n// Add tags to the list\nvar tags = {{tags}};\nvar template = $widget.getChildById('template');\nvar tagList = $widget.getChildById('tags-div');\n\nfunction addTag(tag){\n    var el = template.getModel();\n    el = angular.copy(el);\n    el.id = tag.name;\n    el.html = tag.name;\n    tagList.addChild(0, el);\n}\n\ntags.forEach(addTag);"},"children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","version":"wb4"},{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"div","on":{},"id":"tags-div","children":[],"version":"wb4"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{"flexGrow":"1"},"type":"div","class":"w3-container","children":[{"style":{},"type":"p","html":"{{description}}","on":{},"id":"description","version":"wb4"}],"on":{},"id":"div-body","version":"wb4"}],"class":"w3-padding"}],"on":{},"id":"blog-entry-tmpl-desktop","version":"wb4"}],"id":"div-templates"},{"style":{"display":"flex","flexDirection":"column","padding":"2px","justifyContent":"center","width":"100%","alignItems":"center","paddingTop":"2px","paddingRight":"2px","paddingBottom":"2px","paddingLeft":"2px"},"type":"div","name":"div","on":{"init":"// Show it in edit mode\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        $widget.setProperty('style.display');\n    }\n});\n"},"children":[{"style":{"position":"relative"},"type":"a","on":{},"class":"w3-button w3-black w3-padding-large","html":"موارد بیشتر","id":"load-more-link","version":"wb4"}],"id":"div-load-more","version":"wb4"}],"on":{"init":"// ********************************************************** Inits main content div\nfunction initContentDiv() {\n\n\tvar path = $location.path();\n\tvar id = path.substring(path.lastIndexOf('/') + 1);\n\n\tfunction editData(item) {\n\t\t// Add metas\n\t\titem.metamap = {};\n\t\titem.metas.forEach(function(meta) {\n\t\t\tvar k = meta.key.replace(/\\./g, '_');\n\t\t\titem.metamap[k] = meta.value;\n\t\t});\n\n\t\t// Add tags\n\t\titem.tags = [];\n\t\titem.term_taxonomies.forEach(function(tt) {\n\t\t\tif (tt.taxonomy == 'tag') {\n\t\t\t\tvar val = {\n\t\t\t\t\tname: tt.term.name,\n\t\t\t\t\tcount: tt.count\n\t\t\t\t};\n\t\t\t\titem.tags.push(val);\n\t\t\t}\n\t\t});\n\t\treturn item;\n\t}\n\n\tfunction setPageInfo(data) {\n\t\tvar headerDiv = $widget.getChildById('div-header');\n\t\tvar image = headerDiv.getChildById('image');\n\t\tvar title = headerDiv.getChildById('title');\n\n\t\timage.setProperty('src', '/imgx' + data.metamap.link_cover + '?h=250');\n\t\timage.setProperty('alt', data.title);\n\t\ttitle.setProperty('html', data.title);\n\t}\n\n\tfunction setAuthorInfo(data) {\n\t\tvar authorDiv = $widget.getChildById('overview')\n\t\t\t.getChildById('author');\n\t\tvar avatar = authorDiv.getChildById('avatar');\n\t\tvar name = authorDiv.getChildById('info')\n\t\t\t.getChildById('name');\n\t\tvar about = authorDiv.getChildById('info')\n\t\t\t.getChildById('about');\n\n\t\tavatar.setProperty('src', '/api/v2/user/accounts/' + data.author.id + '/avatar');;\n\t\tvar profile = data.author.profiles[0];\n\t\tname.setProperty('html', '<b>' + profile.first_name + ' ' + profile.last_name + '</b>');\n\t\tabout.setProperty('html', '');\n\n\t\t// Set author_id to be used by other widgets\n\t\t$window.__author__ = data.author;\n\t}\n\n\tfunction initTagsList(data) {\n\t\tvar tagCol = $widget.getChildById('overview')\n\t\t\t.getChildById('tags')\n\t\t\t.getChildById('div-tags')\n\t\t\t.getChildById('tags');\n\t\ttagCol.setProperty('url', '/api/v2/cms/contents/' + data.id + '/term-taxonomies');\n\t}\n\n\tvar url = '/api/v2/cms/contents/' + id;\n\tvar param = {\n\t\tgraphql: '{id,name,title,description,creation_dtime,modif_dtime,metas{key,value},term_taxonomies{taxonomy,count,term{name}},author{id,login,profiles{first_name,last_name}}}'\n\t};\n\n\treturn $http.get(url, { 'params': param })\n\t\t.then(function(res) {\n\t\t\tvar data = res.data;\n\t\t\tdata = editData(data);\n\t\t\tsetPageInfo(data);\n\t\t\tsetAuthorInfo(data);\n\t\t\tinitTagsList(data);\n\t\t\treturn data;\n\t\t});\n\n}\n\n// ********************************************************** Other posts div\nfunction initOtherPostsDiv(contentInfo) {\n\n\tvar ttId = $window.getMeta('theme:articles.category.id');\n\tvar url = ttId ? '/api/v2/cms/term-taxonomies/' + ttId + '/contents' : '/api/v2/cms/contents';\n\t$widget.options = {\n\t\turl: url\n\t};\n\n\tvar myScope = {\n\t\tpaginator: null,\n\t\tparams: null,\n\t\tcollectionBuilder: null,\n\t\tauthor: contentInfo.author\n\t};\n\n\tvar dateOptions = {\n\t\tyear: 'numeric',\n\t\tmonth: 'long',\n\t\tday: 'numeric'\n\t};\n\n\tvar postsWidget = $widget.getChildById('pages-collection');\n\tvar loadMoreLink = $widget.getChildById('div-load-more')\n\t\t.getChildById('load-more-link');\n\n\t// Shorten string\n\tfunction shortenStr(str, len) {\n\t\tvar shortStr = str;\n\t\tif (str.length > len) {\n\t\t\tshortStr = str.substr(0, len);\n\t\t\tshortStr = shortStr + '...';\n\t\t}\n\t\treturn shortStr;\n\t}\n\n\t// Edit data\n\tfunction editData(item) {\n\t\t// Shorten description\n\t\titem.description = shortenStr(item.description, 300);\n\t\t// Add metas\n\t\titem.metamap = {};\n\t\titem.metas.forEach(function(meta) {\n\t\t\tvar k = meta.key.replace(/\\./g, '_');\n\t\t\titem.metamap[k] = meta.value;\n\t\t});\n\n\t\t// Add tags\n\t\titem.tags = [];\n\t\titem.term_taxonomies.forEach(function(tt) {\n\t\t\tif (tt.taxonomy == 'tag') {\n\t\t\t\tvar val = {\n\t\t\t\t\tname: tt.term.name,\n\t\t\t\t\tcount: tt.count\n\t\t\t\t};\n\t\t\t\titem.tags.push(val);\n\t\t\t}\n\t\t});\n\t\t// Data for microdata\n\t\titem.creation_dtime_iso = new Date(item.creation_dtime).toLocaleDateString('fa-IR', dateOptions);\n\t\titem.modif_dtime_iso = new Date(item.modif_dtime).toLocaleDateString('fa-IR', dateOptions);\n\t\treturn item;\n\t}\n\n\tfunction addItemsToCollection(postList) {\n\t\t// Get post item template\n\t\tif (myScope.collectionBuilder == null) { // First call, create and init collection builder\n\t\t\t// Load template}\n\t\t\tvar tmplId = window.matchMedia(\"(max-width: 576px)\").matches ? 'blog-entry-tmpl-mobile' : 'blog-entry-tmpl-desktop'; \n\t\t\tvar template = $widget.getChildById('div-templates')\n\t\t\t\t.getChildById(tmplId).getModel();\n\t\t\tvar template = angular.copy(template);\n\t\t\t// Build collection\n\t\t\tmyScope.collectionBuilder = new CollectionBuilder();\n\t\t\tmyScope.collectionBuilder.setTemplate(template)\n\t\t\t\t.setItems(postList)\n\t\t\t\t.setWidget(postsWidget)\n\t\t\t\t.build();\n\t\t} else {\n\t\t\tfor (const item of postList) {\n\t\t\t\tmyScope.collectionBuilder.addItem(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getParams() {\n\t\tif (myScope.params == null) { // Initiate params from URL\n\t\t\tvar params = $window.location.search;\n\t\t\tparams = new URLSearchParams(params);\n\t\t\tparams.set('graphql', '{counts,current_page,items_per_page,page_number,items{id,name,title,description,downloads,creation_dtime,modif_dtime,metas{key,value},term_taxonomies{taxonomy,count,term{name}}}}');\n\t\t\tif (!params.has('_px_fk')) {\n\t\t\t\tparams.set('_px_fk[]', 'media_type');\n\t\t\t\tparams.set('_px_fv[]', 'page');\n\t\t\t\tparams.append('_px_fk[]', 'author_id');\n\t\t\t\tparams.append('_px_fv[]', myScope.author.id);\n\t\t\t}\n\t\t\tif (!params.has('_px_sk')) {\n\t\t\t\tparams.set('_px_sk', 'downloads');\n\t\t\t\tparams.set('_px_so', 'd');\n\t\t\t}\n\t\t\tif (!params.has('_px_p')) {\n\t\t\t\tparams.set('_px_p', 1);\n\t\t\t}\n\t\t\tif (!params.has('_px_ps')) {\n\t\t\t\tparams.set('_px_ps', 12);\n\t\t\t}\n\t\t\tvar keys = params.keys();\n\t\t\tvar paramsJson = {};\n\t\t\tfor (const key of keys) {\n\t\t\t\tparamsJson[key] = params.getAll(key);\n\t\t\t}\n\t\t\tmyScope.params = paramsJson;\n\t\t}\n\t\treturn myScope.params;\n\t}\n\n\tfunction initLoadMoreLink(pag) {\n\t\tif (pag.current_page >= pag.page_number) {\n\t\t\tloadMoreLink.setProperty('style.display', 'none');\n\t\t\tloadMoreLink.setProperty('href', '#');\n\t\t} else {\n\t\t\tvar params = $location.search();\n\t\t\tparams = new URLSearchParams(params);\n\t\t\tparams.set('_px_p', pag.current_page + 1);\n\t\t\turl = $location.absUrl();\n\t\t\turl = url.indexOf('?') >= 0 ? url.substring(0, url.indexOf('?')) : url;\n\t\t\tvar newUrl = url + '?' + params.toString();\n\t\t\tloadMoreLink.setProperty('href', newUrl);\n\t\t}\n\t}\n\n\tfunction loadNextPage(params) {\n\t\t$http({\n\t\t\tmethod: 'GET',\n\t\t\turl: $widget.options.url,\n\t\t\tparams: params\n\t\t}).then(function(result) {\n\t\t\tvar items = result.data.items;\n\t\t\tvar dataList = [];\n\t\t\tvar pos = 1;\n\t\t\titems.forEach(function(item) {\n\t\t\t\t// Edit data of product\n\t\t\t\tvar data = editData(item);\n\t\t\t\tdata.position = pos++;\n\t\t\t\tdataList.push(data);\n\t\t\t});\n\t\t\tmyScope.paginator = result.data;\n\t\t\tinitLoadMoreLink(myScope.paginator);\n\t\t\taddItemsToCollection(dataList);\n\t\t});\n\t}\n\n\tfunction loadMoreClicked(ev) {\n\t\tev.preventDefault();\n\t\tev.stopImmediatePropagation();\n\t\tev.stopPropagation();\n\n\t\tif ($widget.state == 'ready') {\n\t\t\tvar pag = myScope.paginator;\n\t\t\tif (pag.current_page < pag.page_number) {\n\t\t\t\tvar params = getParams();\n\t\t\t\tparams._px_p = Number(params._px_p) + 1;\n\t\t\t\treturn loadNextPage(params);\n\t\t\t} else {\n\t\t\t\tloadMoreLink.setProperty('style.display', 'none');\n\t\t\t\tloadMoreLink.setProperty('href');\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction init() {\n\t\t// Clear Collection\n\t\tpostsWidget.removeChildren();\n\t\t// Load Items\n\t\tmyScope = {\n\t\t\tpaginator: null,\n\t\t\tparams: null,\n\t\t\tcollectionBuilder: null,\n\t\t\tauthor: contentInfo.author\n\t\t};\n\t\tloadNextPage(getParams());\n\t\t// Set on-click action of load-more-link\n\t\tloadMoreLink.on('click', loadMoreClicked);\n\t}\n\n\tinit();\n\n}\n\n// Initialize the page\ninitContentDiv()\n\t.then(initOtherPostsDiv);\n\n"},"version":"wb4","id":"div-center"},{"style":{},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/blog-widgets/content#main-footer","id":"import-footer"}],"id":"body","class":"w3-light-grey","modules":[{"title":"W3 CSS","url":"https://www.w3schools.com/w3css/4/w3.css","type":"css","load":"lazy","state":"success"},{"title":"Google API","url":"https://fonts.googleapis.com/css?family=Raleway","type":"css","load":"lazy","state":"success"},{"title":"Persian Fonts","url":"//cdn.viraweb123.ir/api/v2/cdn/libs/persian-free-fonts@0.1.0/fonts.css","type":"css","load":"lazy","state":"success"},{"title":"Fontawsome 4.7","url":"https://cdn.viraweb123.ir/api/v2/cdn/libs/Font-Awesome@4.7.0/css/font-awesome.min.css","type":"css","load":"lazy","state":"success"},{"title":"Collection Builder JS","url":"//cdn.viraweb123.ir/api/v2/cdn/libs/modules@0.2.11/dist/collection-builder.min.js","type":"js","load":"before","state":"success"}]}