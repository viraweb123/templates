{"type":"div","style":{"margin":"0px","padding":"0px","display":"flex","flexDirection":"column","minHeight":"100vh","direction":"rtl","marginTop":"0px","marginRight":"0px","marginBottom":"0px","marginLeft":"0px"},"on":{"init":"$window.scrollTo(0,0);\n"},"version":"wb4","children":[{"style":{},"type":"style","children":[],"on":{},"version":"wb4","text":"body, h1, h2, h3, h4, h5, h6 {\n\tfont-family: Gandom, BKoodakBold, Roboto, \"Helvetica Neue\", sans-serif;\n}\n\nbody {\n    font-size: 15px;\n}\nh1, h2, h3, h4, h5, h6{\n    font-weight: bold;\n    line-height: 1.9;\n}\nh1{font-size:28px} \nh2{font-size:24px} \nh3{font-size:20px} \nh4{font-size:18px} \nh5{font-size:16px} \nh6{font-size:14px}\np {\n    font-size: 16px;\n    line-height: 1.9;\n}\nli {\n    font-size: 16px;\n    line-height: 1.8;\n}"},{"style":{},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/scripts/content#script-libs","id":"import-scripts"},{"style":{},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/blog-widgets/content#main-toolbar","id":"import-toolbar"},{"style":{},"type":"header","class":"w3-container w3-center w3-padding-32","children":[{"style":{"position":"relative"},"type":"h1","html":"<b>ایستا بتن تَچَر</b>","on":{},"id":"h1-title","version":"wb4"}],"on":{"init":"var brand = $window.getMeta('theme:brand_title');\nvar ttid = $routeParams['ttid'];\nif(ttid){\n    var h1Title = $widget.getChildById('h1-title');\n    var prms = {\n        graphql: '{id,taxonomy,description,count,term{id,name}}'\n    }\n    $http.get('/api/v2/cms/term-taxonomies/' + ttid, {params: prms})\n    .then(function(res){\n        var data = res.data;\n        var termName = data.term.name;\n        h1Title.setProperty('html', '<b>'+termName+'</b>');\n        setMetadata(data);\n    });\n}\n\nfunction setMetadata(data){\n    $document.attr('title', data.term.name + ' | ' + brand);\n\t$window.setMeta('description', data.description);\n\tvar params = $window.location.search;\n\tvar canLink = params && params.length > 1 ? '/wb/blog/pages'+params : '/wb/blog/pages'; \n\t$window.setLink('canonical', {\n\t\t'rel': 'canonical',\n\t\t'href': canLink\n\t});\n}"},"version":"wb4","id":"header"},{"style":{"maxWidth":"1400px"},"type":"div","class":"w3-content","children":[{"style":{"display":"flex","flexDirection":"row","flexWrap":"wrap"},"type":"div","class":"w3-row","children":[{"style":{"flexGrow":"100","flexShrink":"1","display":"flex","flexBasis":"600px","flexDirection":"column"},"type":"div","on":{"init":"var ttId = $routeParams['ttid'];\nvar url = ttId ? '/api/v2/cms/term-taxonomies/'+ttId+'/contents' : '/api/v2/cms/contents';\n$widget.options = {\n    url: url\n};\nvar dateOptions = {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n};\n\nvar postsWidget = $widget.getChildById('most-visited-collection');\n\n// Shorten string\nfunction shortenStr(str, len){\n    var shortStr = str;\n    if(str.length > len){\n        shortStr = str.substr(0, len);\n        shortStr = shortStr + '...';\n    }\n    return shortStr;\n}\n\n// Edit data\nfunction editData(item){\n    // Shorten description\n    // item.description = shortenStr(item.description, 100);\n    // Add metas\n    item.metamap = {};\n    item.metas.forEach(function(meta){\n        var k = meta.key.replace(/\\./g, '_');\n        item.metamap[k] = meta.value;\n    });\n    \n    // Add tags\n    item.tags = [];\n    item.term_taxonomies.forEach(function(tt){\n        if(tt.taxonomy == 'tag'){\n            var val = {\n                name: tt.term.name,\n                count: tt.count\n            };\n            item.tags.push(val);\n        }\n    });\n    // Data for microdata\n    var dt = item.creation_dtime.replace(' ', 'T');\n    item.creation_dtime_iso = new Date(dt).toLocaleDateString('fa-IR', dateOptions);\n\tdt = item.modif_dtime.replace(' ', 'T');\n    item.modif_dtime_iso = new Date(dt).toLocaleDateString('fa-IR', dateOptions);\n    return item;\n}\n\n\nfunction createPostsCollection(postList){\n    // Get post item template\n    var template = $widget.getChildById('div-templates')\n                    .getChildById('blog-entry-tmpl').getModel();\n    var template = angular.copy(template);\n    \n    // Build collection\n    var collectionBuilder = new CollectionBuilder();\n    collectionBuilder.setTemplate(template)\n        .setItems(postList)\n        .setWidget(postsWidget)\n        .build();\n}\n\n\n// Clear collections\npostsWidget.removeChildren();\n\n$http({\n    method: 'GET',\n    url: $widget.options.url,\n    params: {\n        graphql: '{counts,current_page,items_per_page,page_number,items{id,name,title,description,creation_dtime,modif_dtime,metas{key,value},term_taxonomies{taxonomy,count,term{name}}}}',\n        _px_fk: 'media_type',\n        _px_fv: 'page',\n        _px_sk: 'downloads',\n        _px_so: 'd',\n        _px_ps: 8\n    }    \n}).then(function(result){\n    var items = result.data.items;\n    var dataList = [];\n    var promise;\n    var pos = 1;\n    items.forEach(function(item){\n        // Edit data of product\n        var data = editData(item);\n        data.position = pos++;\n        dataList.push(data);\n    });\n    createPostsCollection(dataList);\n});\n\n"},"class":"w3-col","children":[{"style":{},"type":"div","class":"w3-card w3-margin w3-white","children":[{"style":{},"type":"div","class":"w3-container w3-padding","children":[{"style":{"position":"relative","textAlign":"center"},"type":"h4","html":"پربازدیدترین پست&zwnj;ها","on":{},"version":"wb4"}],"on":{},"version":"wb4"}],"on":{},"version":"wb4"},{"type":"div","on":{"init":"$widget.on('stateChanged', function(){\n    if($widget.state == 'edit'){\n        $widget.removeChildren();\n    }\n});"},"style":{"display":"flex","flexWrap":"wrap","flexDirection":"row","justifyContent":"center","flexGrow":"1"},"children":[],"id":"most-visited-collection","class":"w3-col","filters":[],"sorts":[],"version":"wb4"},{"type":"div","on":{"init":"// Hide template\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        $widget.setProperty('style.display');\n    }else{\n        $widget.setProperty('style.display', 'none');\n    }\n});"},"style":{"flexGrow":"100","flexShrink":"1","display":"flex","flexWrap":"wrap","flexBasis":"600px","flexDirection":"row","justifyContent":"center","alignContent":"flex-start"},"children":[{"style":{"flexBasis":"400px","flexDirection":"column","display":"flex","flexShrink":"1","flexGrow":"1"},"type":"div","children":[{"style":{},"type":"meta","children":[],"on":{},"version":"wb4","id":"published","itemprop":"datePublished","content":"{{creation_dtime}}"},{"style":{},"type":"meta","children":[],"on":{},"version":"wb4","id":"modified","itemprop":"dateModified","content":"{{modif_dtime}}"},{"style":{},"type":"div","itemprop":"author","itemscope":"true","itemtype":"https://schema.org/Person","children":[{"style":{},"type":"meta","itemprop":"identifier","content":"{{author.id}}","children":[],"on":{},"version":"wb4","id":"identifier"},{"style":{},"type":"meta","itemprop":"name","content":"{{author.profiles.0.first_name}} {{author.profiles.0.last_name}} در هفت طوطی","children":[],"on":{},"version":"wb4","id":"name"},{"style":{},"type":"meta","itemprop":"familyName","content":"{{author.profiles.1.last_name}}","children":[],"on":{},"version":"wb4","id":"familyName"},{"style":{},"type":"meta","itemprop":"givenName","content":"{{author.profiles.0.first_name}}","children":[],"on":{},"version":"wb4","id":"givenName"},{"style":{},"type":"meta","itemprop":"image","content":"/api/v2/user/accounts/{{author.id}}/avatar","children":[],"on":{},"version":"wb4","id":"image"}],"on":{},"version":"wb4","id":"author"},{"style":{},"type":"div","itemprop":"publisher","itemscope":"true","itemtype":"https://schema.org/Organization","children":[{"style":{},"type":"meta","itemprop":"name","content":"هفت طوطی","on":"[object Object]","id":"name","children":[],"version":"wb4"},{"style":{},"type":"div","itemprop":"logo","itemscope":"true","itemtype":"https://schema.org/ImageObject","children":[{"style":{},"type":"meta","itemprop":"url","content":"/api/v2/cms/contents/logo/content","on":"[object Object]","id":"url","children":[],"version":"wb4"},{"style":{},"type":"meta","itemprop":"height","content":"500","on":"[object Object]","id":"height","children":[],"version":"wb4"},{"style":{},"type":"meta","itemprop":"width","content":"500","on":"[object Object]","id":"width","children":[],"version":"wb4"}],"on":{},"version":"wb4","id":"logo"}],"on":{},"version":"wb4","id":"publisher"},{"style":{"objectFit":"cover","objectPosition":"top","height":"230px","maxWidth":"100%"},"type":"img","alt":"{{title}}","html":"","on":{},"src":"/imgx{{{metamap.link_cover}}}?h=230&w=450&f=cover","version":"wb4","itemprop":"image"},{"style":{},"type":"div","class":"w3-container","children":[{"style":{"position":"relative","textDecoration":"none"},"type":"a","html":"<h3><b>{{title}}</b></h3>","on":{},"id":"title","version":"wb4","itemprop":"headline","href":"{{{metamap.link_canonical}}}"},{"style":{},"type":"h5","html":"آخرین بروزرسانی: <span class=\"w3-opacity\">{{modif_dtime_iso}}</span>","on":{},"id":"h5-subtitle","version":"wb4"},{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{"init":"// Hide template\nvar tmpl = $widget.getChildById('template');\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        tmpl.setProperty('style.display');\n    }else{\n        tmpl.setProperty('style.display', 'none');\n    }\n});\n\n// Add tags to the list\nvar tags = {{tags}};\nvar template = $widget.getChildById('template');\nvar tagList = $widget.getChildById('tags-div');\n\nfunction addTag(tag){\n    var el = template.getModel();\n    el = angular.copy(el);\n    el.id = tag.name;\n    el.html = tag.name;\n    tagList.addChild(0, el);\n}\n\ntags.forEach(addTag);"},"children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","version":"wb4"},{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"div","on":{},"id":"tags-div","children":[],"version":"wb4"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{"flexGrow":"1"},"type":"div","class":"w3-container","children":[{"style":{},"type":"p","html":"{{description}}","on":{},"id":"description","version":"wb4","itemprop":"description"}],"on":{},"id":"div-body","version":"wb4"},{"style":{"display":"flex","justifyContent":"flex-end","padding":"16px","paddingTop":"16px","paddingRight":"16px","paddingBottom":"16px","paddingLeft":"16px"},"type":"div","class":"w3-row","children":[{"type":"a","on":{},"style":{},"class":"w3-button w3-padding-large w3-white w3-border","html":"<b>ادامه مطلب &raquo;</b>","href":"{{{metamap.link_canonical}}}","version":"wb4","itemprop":"mainEntityOfPage"}],"on":{},"id":"div-footer","version":"wb4"}],"on":{},"version":"wb4","id":"blog-entry-tmpl","class":"w3-card-4 w3-margin w3-white","itemscope":"true","itemtype":"https://schema.org/BlogPosting"}],"id":"div-templates","class":"w3-col","filters":[],"sorts":[],"version":"wb4"}],"id":"div-most-visited","version":"wb4"},{"style":{"flexBasis":"350px","flexGrow":"1","display":"flex","flexDirection":"row","flexWrap":"wrap","alignContent":"flex-start"},"type":"div","class":"w3-col","children":[{"style":{},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/blog-widgets/content#div-intro","id":"import-div-intro"},{"style":{"flexDirection":"row","display":"flex","flexGrow":"1","flexWrap":"wrap"},"type":"div","name":"div","on":{},"version":"wb4","children":[{"style":{"flexBasis":"300px","flexGrow":"1"},"type":"div","class":"w3-card w3-margin","children":[{"style":{},"type":"div","class":"w3-container w3-padding","children":[{"style":{"position":"relative"},"type":"h4","html":"برچسب&zwnj;ها","on":{},"version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{},"type":"div","class":"w3-container w3-white","children":[{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{},"children":[{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"ObjectCollection","name":"Object collection","on":{},"url":"/api/v2/cms/term-taxonomies?graphql={items{id,taxonomy,description,count,term{name}}}","template":"{\"html\":\"{{term.name}}\",\"type\":\"a\",\"name\":\"A link\",\"on\":{},\"style\":{\"borderRadius\":\"2px\",\"padding\":\"4px\",\"margin\":\"8px\",\"borderTopLeftRadius\":\"2px\",\"borderTopRightRadius\":\"2px\",\"borderBottomRightRadius\":\"2px\",\"borderBottomLeftRadius\":\"2px\",\"paddingTop\":\"4px\",\"paddingRight\":\"4px\",\"paddingBottom\":\"4px\",\"paddingLeft\":\"4px\",\"marginTop\":\"8px\",\"marginRight\":\"8px\",\"marginBottom\":\"8px\",\"marginLeft\":\"8px\",\"textDecoration\":\"none\",\"textDecorationLine\":\"none\",\"textDecorationStyle\":\"initial\",\"textDecorationColor\":\"initial\"},\"id\":\"template\",\"class\":\"w3-tag w3-light-grey w3-small w3-margin-bottom\",\"href\":\"blog/pages?ttid={{id}}\",\"version\":\"wb4\"}","id":"tags","children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","padding":"4px","margin":"8px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px","paddingTop":"4px","paddingRight":"4px","paddingBottom":"4px","paddingLeft":"4px","marginTop":"8px","marginRight":"8px","marginBottom":"8px","marginLeft":"8px","textDecoration":"none","textDecorationLine":"none","textDecorationStyle":"initial","textDecorationColor":"initial"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","href":"blog/posts?ttid={{id}}","version":"wb4"}],"filters":[{"key":"taxonomy","value":"tag"}],"version":"wb4"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"div-body","version":"wb4"}],"on":{},"id":"tags","version":"wb4"},{"style":{"flexBasis":"300px","flexGrow":"1"},"type":"div","class":"w3-card w3-margin","children":[{"style":{},"type":"div","class":"w3-container w3-padding","children":[{"style":{"position":"relative"},"type":"h4","html":"دسته بندی&zwnj;ها","on":{},"version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{},"type":"div","class":"w3-container w3-white","children":[{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{},"children":[{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"ObjectCollection","name":"Object collection","on":{},"url":"/api/v2/cms/term-taxonomies","template":"{\"html\":\"{{term.name}}\",\"type\":\"a\",\"name\":\"A link\",\"on\":{},\"style\":{\"borderRadius\":\"2px\",\"padding\":\"4px\",\"margin\":\"8px\",\"borderTopLeftRadius\":\"2px\",\"borderTopRightRadius\":\"2px\",\"borderBottomRightRadius\":\"2px\",\"borderBottomLeftRadius\":\"2px\",\"paddingTop\":\"4px\",\"paddingRight\":\"4px\",\"paddingBottom\":\"4px\",\"paddingLeft\":\"4px\",\"marginTop\":\"8px\",\"marginRight\":\"8px\",\"marginBottom\":\"8px\",\"marginLeft\":\"8px\",\"textDecoration\":\"none\",\"textDecorationLine\":\"none\",\"textDecorationStyle\":\"initial\",\"textDecorationColor\":\"initial\"},\"id\":\"template\",\"class\":\"w3-tag w3-light-grey w3-small w3-margin-bottom\",\"href\":\"blog/pages?ttid={{id}}\",\"version\":\"wb4\"}","id":"cats","children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","padding":"4px","margin":"8px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px","paddingTop":"4px","paddingRight":"4px","paddingBottom":"4px","paddingLeft":"4px","marginTop":"8px","marginRight":"8px","marginBottom":"8px","marginLeft":"8px","textDecoration":"none","textDecorationLine":"none","textDecorationStyle":"initial","textDecorationColor":"initial"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","href":"blog/posts?ttid={{id}}","version":"wb4"}],"filters":[{"key":"taxonomy","value":"category"}],"properties":"{items{id,taxonomy,description,count,term{name}}}","version":"wb4"}],"id":"div-cats","version":"wb4"}],"on":{},"id":"div-body","version":"wb4"}],"on":{},"id":"categories","version":"wb4"},{"style":{"flexBasis":"300px","flexGrow":"1"},"type":"div","class":"w3-card w3-margin","children":[{"style":{},"type":"div","class":"w3-container w3-padding","children":[{"style":{"position":"relative"},"type":"h4","html":"گالری&zwnj;ها","on":{},"version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{},"type":"div","class":"w3-container w3-white","children":[{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{},"children":[{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"ObjectCollection","name":"Object collection","on":{},"url":"/api/v2/cms/term-taxonomies?graphql={items{id,taxonomy,description,count,term{name}}}","template":"{\"html\":\"{{term.name}}\",\"type\":\"a\",\"name\":\"A link\",\"on\":{},\"style\":{\"borderRadius\":\"2px\",\"padding\":\"4px\",\"margin\":\"8px\",\"borderTopLeftRadius\":\"2px\",\"borderTopRightRadius\":\"2px\",\"borderBottomRightRadius\":\"2px\",\"borderBottomLeftRadius\":\"2px\",\"paddingTop\":\"4px\",\"paddingRight\":\"4px\",\"paddingBottom\":\"4px\",\"paddingLeft\":\"4px\",\"marginTop\":\"8px\",\"marginRight\":\"8px\",\"marginBottom\":\"8px\",\"marginLeft\":\"8px\",\"textDecoration\":\"none\",\"textDecorationLine\":\"none\",\"textDecorationStyle\":\"initial\",\"textDecorationColor\":\"initial\"},\"id\":\"template\",\"class\":\"w3-tag w3-light-grey w3-small w3-margin-bottom\",\"href\":\"blog/gallery?ttid={{id}}\",\"version\":\"wb4\"}","id":"tags","children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","padding":"4px","margin":"8px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px","paddingTop":"4px","paddingRight":"4px","paddingBottom":"4px","paddingLeft":"4px","marginTop":"8px","marginRight":"8px","marginBottom":"8px","marginLeft":"8px","textDecoration":"none","textDecorationLine":"none","textDecorationStyle":"initial","textDecorationColor":"initial"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","href":"blog/gallery?ttid={{id}}","version":"wb4"}],"filters":[{"key":"taxonomy","value":"tag"}],"version":"wb4"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"div-body","version":"wb4"}],"on":{},"id":"gallery-tags","version":"wb4"}]}],"on":{},"id":"overview","version":"wb4"}],"on":{},"id":"div-top","version":"wb4"},{"style":{},"type":"hr","name":"hr","on":{},"version":"wb4"},{"style":{"display":"flex","flexDirection":"column"},"type":"div","class":"w3-row","children":[{"style":{"display":"flex","flexWrap":"wrap","flexDirection":"row","justifyContent":"center","alignContent":"flex-start"},"on":{"init":"$widget.on('stateChanged', function(){\n    if($widget.state == 'edit'){\n        $widget.removeChildren();\n    }\n});"},"children":[],"class":"w3-row","id":"pages-collection","filters":[],"sorts":[],"version":"wb4","type":"div"},{"type":"div","on":{"init":"// Hide template\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        $widget.setProperty('style.display');\n    }else{\n        $widget.setProperty('style.display', 'none');\n    }\n});"},"style":{"display":"flex","flexDirection":"row","justifyContent":"center","alignContent":"flex-start"},"children":[{"style":{"flexBasis":"300px","flexDirection":"column","display":"flex","flexShrink":"1","flexGrow":"1"},"type":"div","children":[{"style":{},"type":"meta","children":[],"on":{},"version":"wb4","id":"published","itemprop":"datePublished","content":"{{creation_dtime}}"},{"style":{},"type":"meta","children":[],"on":{},"version":"wb4","id":"modified","itemprop":"dateModified","content":"{{modif_dtime}}"},{"style":{},"type":"div","itemprop":"author","itemscope":"true","itemtype":"https://schema.org/Person","children":[{"style":{},"type":"meta","itemprop":"identifier","content":"{{author.id}}","children":[],"on":{},"version":"wb4","id":"identifier"},{"style":{},"type":"meta","itemprop":"name","content":"{{author.profiles.0.first_name}} {{author.profiles.0.last_name}} در هفت طوطی","children":[],"on":{},"version":"wb4","id":"name"},{"style":{},"type":"meta","itemprop":"familyName","content":"{{author.profiles.1.last_name}}","children":[],"on":{},"version":"wb4","id":"familyName"},{"style":{},"type":"meta","itemprop":"givenName","content":"{{author.profiles.0.first_name}}","children":[],"on":{},"version":"wb4","id":"givenName"},{"style":{},"type":"meta","itemprop":"image","content":"/api/v2/user/accounts/{{author.id}}/avatar","children":[],"on":{},"version":"wb4","id":"image"}],"on":{},"version":"wb4","id":"author"},{"style":{},"type":"div","itemprop":"publisher","itemscope":"true","itemtype":"https://schema.org/Organization","children":[{"style":{},"type":"meta","itemprop":"name","content":"هفت طوطی","on":"[object Object]","id":"name","children":[],"version":"wb4"},{"style":{},"type":"div","itemprop":"logo","itemscope":"true","itemtype":"https://schema.org/ImageObject","children":[{"style":{},"type":"meta","itemprop":"url","content":"/api/v2/cms/contents/logo/content","on":"[object Object]","id":"url","children":[],"version":"wb4"},{"style":{},"type":"meta","itemprop":"height","content":"500","on":"[object Object]","id":"height","children":[],"version":"wb4"},{"style":{},"type":"meta","itemprop":"width","content":"500","on":"[object Object]","id":"width","children":[],"version":"wb4"}],"on":{},"version":"wb4","id":"logo"}],"on":{},"version":"wb4","id":"publisher"},{"style":{"objectFit":"cover","objectPosition":"center top","height":"170px","maxWidth":"100%"},"type":"img","alt":"{{title}}","html":"","on":{},"src":"/imgx{{{metamap.link_cover}}}?h=170&w=450&f=cover","version":"wb4","itemprop":"image"},{"style":{},"type":"div","class":"w3-container","children":[{"style":{"position":"relative","textDecoration":"none"},"type":"a","html":"<h3><b>{{title}}</b></h3>","on":{},"id":"title","version":"wb4","itemprop":"headline","href":"{{{metamap.link_canonical}}}"},{"style":{},"type":"h5","html":"آخرین بروزرسانی: <span class=\"w3-opacity\">{{modif_dtime_iso}}</span>","on":{},"id":"h5-subtitle","version":"wb4"},{"style":{"display":"flex","flexDirection":"row","justifyContent":"flex-start","padding":"0px 16px 8px 0px","paddingTop":"0px","paddingRight":"16px","paddingBottom":"8px","paddingLeft":"0px"},"type":"div","name":"div","on":{"init":"// Hide template\nvar tmpl = $widget.getChildById('template');\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        tmpl.setProperty('style.display');\n    }else{\n        tmpl.setProperty('style.display', 'none');\n    }\n});\n\n// Add tags to the list\nvar tags = {{tags}};\nvar template = $widget.getChildById('template');\nvar tagList = $widget.getChildById('tags-div');\n\nfunction addTag(tag){\n    var el = template.getModel();\n    el = angular.copy(el);\n    el.id = tag.name;\n    el.html = tag.name;\n    tagList.addChild(0, el);\n}\n\ntags.forEach(addTag);"},"children":[{"html":"{{term.name}}","type":"a","name":"A link","on":{},"style":{"borderRadius":"2px","borderTopLeftRadius":"2px","borderTopRightRadius":"2px","borderBottomRightRadius":"2px","borderBottomLeftRadius":"2px"},"id":"template","class":"w3-tag w3-light-grey w3-small w3-margin-bottom","version":"wb4"},{"style":{"flexGrow":"1","flexShrink":"1","display":"flex","justifyContent":"flex-start","flexWrap":"wrap"},"type":"div","on":{},"id":"tags-div","children":[],"version":"wb4"}],"id":"div-tags","version":"wb4"}],"on":{},"id":"div-header","version":"wb4"},{"style":{"flexGrow":"1"},"type":"div","class":"w3-container","children":[{"style":{"position":"relative"},"type":"p","html":"{{description}}","on":{},"id":"description","version":"wb4"}],"on":{},"id":"div-body","version":"wb4"},{"style":{"display":"flex","justifyContent":"flex-end","padding":"16px","paddingTop":"16px","paddingRight":"16px","paddingBottom":"16px","paddingLeft":"16px"},"type":"div","class":"w3-row","children":[{"type":"a","on":{},"style":{},"class":"w3-button w3-padding-large w3-white w3-border","html":"<b>ادامه مطلب &raquo;</b>","href":"{{{metamap.link_canonical}}}","version":"wb4","itemprop":"mainEntityOfPage"}],"on":{},"id":"div-footer","version":"wb4"}],"on":{},"version":"wb4","id":"blog-entry-tmpl","class":"w3-card-4 w3-margin w3-white","itemscope":"true","itemtype":"https://schema.org/BlogPosting"}],"id":"div-templates","class":"w3-col","filters":[],"sorts":[],"version":"wb4"},{"style":{"display":"flex","flexDirection":"column","padding":"2px","justifyContent":"center","width":"100%","alignItems":"center","paddingTop":"2px","paddingRight":"2px","paddingBottom":"2px","paddingLeft":"2px"},"type":"div","name":"div","on":{"init":"// Show it in edit mode\n$widget.on('stateChanged', function(ev){\n    if(ev.value == 'edit'){\n        $widget.setProperty('style.display');\n    }\n});\n"},"children":[{"style":{"position":"relative"},"type":"a","on":{},"class":"w3-button w3-black w3-padding-large","html":"موارد بیشتر","id":"load-more-link","version":"wb4"}],"id":"div-load-more","version":"wb4"}],"on":{"init":"var ttId = $routeParams['ttid'];\nvar url = ttId ? '/api/v2/cms/term-taxonomies/'+ttId+'/contents' : '/api/v2/cms/contents';\n$widget.options = {\n    url: url\n};\n\nvar myScope = {\n\tpaginator: null,\n\tparams: null,\n\tcollectionBuilder: null\n};\n\nvar dateOptions = {\n\tyear: 'numeric',\n\tmonth: 'long',\n\tday: 'numeric'\n};\n\nvar postsWidget = $widget.getChildById('pages-collection');\nvar loadMoreLink = $widget.getChildById('div-load-more')\n\t\t\t\t.getChildById('load-more-link');\n\n// Shorten string\nfunction shortenStr(str, len) {\n\tvar shortStr = str;\n\tif (str.length > len) {\n\t\tshortStr = str.substr(0, len);\n\t\tshortStr = shortStr + '...';\n\t}\n\treturn shortStr;\n}\n\n// Edit data\nfunction editData(item) {\n\t// Shorten description\n\titem.description = shortenStr(item.description, 300);\n\t// Add metas\n\titem.metamap = {};\n\titem.metas.forEach(function(meta) {\n\t\tvar k = meta.key.replace(/\\./g, '_');\n\t\titem.metamap[k] = meta.value;\n\t});\n\n\t// Add tags\n\titem.tags = [];\n\titem.term_taxonomies.forEach(function(tt) {\n\t\tif (tt.taxonomy == 'tag') {\n\t\t\tvar val = {\n\t\t\t\tname: tt.term.name,\n\t\t\t\tcount: tt.count\n\t\t\t};\n\t\t\titem.tags.push(val);\n\t\t}\n\t});\n\t// Data for microdata\n\tvar dt = item.creation_dtime.replace(' ', 'T');\n    item.creation_dtime_iso = new Date(dt).toLocaleDateString('fa-IR', dateOptions);\n\tdt = item.modif_dtime.replace(' ', 'T');\n    item.modif_dtime_iso = new Date(dt).toLocaleDateString('fa-IR', dateOptions);\n\treturn item;\n}\n\nfunction addItemsToCollection(postList) {\n\t// Get post item template\n\tif (myScope.collectionBuilder == null) { // First call, create and init collection builder\n\t\t// Load template\n\t\tvar template = $widget.getChildById('div-templates')\n\t\t\t.getChildById('blog-entry-tmpl').getModel();\n\t\tvar template = angular.copy(template);\n\t\t// Build collection\n\t\tmyScope.collectionBuilder = new CollectionBuilder();\n\t\tmyScope.collectionBuilder.setTemplate(template)\n\t\t\t.setItems(postList)\n\t\t\t.setWidget(postsWidget)\n\t\t\t.build();\n\t} else {\n\t\tfor (const item of postList) {\n\t\t\tmyScope.collectionBuilder.addItem(item);\n\t\t}\n\t}\n}\n\nfunction getParams() {\n\tif (myScope.params == null) { // Initiate params from URL\n\t\tvar params = $window.location.search;\n\t\tparams = new URLSearchParams(params);\n\t\tparams.set('graphql', '{counts,current_page,items_per_page,page_number,items{id,name,title,description,downloads,creation_dtime,modif_dtime,metas{key,value},term_taxonomies{taxonomy,count,term{name}}}}');\n\t\tif (!params.has('_px_fk') || params.get('_px_fk') != 'media_type') {\n\t\t\tparams.set('_px_fk', 'media_type');\n\t\t\tparams.set('_px_fv', 'page');\n\t\t}\n\t\tif (!params.has('_px_sk')) {\n\t\t\tparams.set('_px_sk', 'modif_dtime');\n\t\t\tparams.set('_px_so', 'd');\n\t\t}\n\t\tif (!params.has('_px_p')) {\n\t\t\tparams.set('_px_p', 1);\n\t\t}\n\t\tif(!params.has('_px_ps')){\n\t\t\tparams.set('_px_ps', 12);\n\t\t}\n\t\tvar keys = params.keys();\n\t\tvar paramsJson = {};\n\t\tfor (const key of keys) {\n\t\t\tparamsJson[key] = params.get(key);\n\t\t}\n\t\tmyScope.params = paramsJson;\n\t}\n\treturn myScope.params;\n}\n\nfunction initLoadMoreLink(pag) {\n\tif (pag.current_page >= pag.page_number) {\n\t\tloadMoreLink.setProperty('style.display', 'none');\n\t\tloadMoreLink.setProperty('href', '#');\n\t} else {\n\t\tvar params = $location.search();\n\t\tparams = new URLSearchParams(params);\n\t\tparams.set('_px_p', pag.current_page + 1);\n\t\turl = $location.absUrl();\n\t\turl = url.indexOf('?') >= 0 ? url.substring(0, url.indexOf('?')) : url;\n\t\tvar newUrl = url + '?' + params.toString();\n\t\tloadMoreLink.setProperty('href', newUrl);\n\t}\n}\n\nfunction loadNextPage(params) {\n\t$http({\n\t\tmethod: 'GET',\n\t\turl: $widget.options.url,\n\t\tparams: params\n\t}).then(function(result) {\n\t\tvar items = result.data.items;\n\t\tvar dataList = [];\n\t\tvar pos = 1;\n\t\titems.forEach(function(item) {\n\t\t\t// Edit data of product\n\t\t\tvar data = editData(item);\n\t\t\tdata.position = pos++;\n\t\t\tdataList.push(data);\n\t\t});\n\t\tmyScope.paginator = result.data;\n\t\tinitLoadMoreLink(myScope.paginator);\n\t\taddItemsToCollection(dataList);\n\t});\n}\n\nfunction loadMoreClicked(ev) {\n\tev.preventDefault();\n\tev.stopImmediatePropagation();\n\tev.stopPropagation();\n\n\tif ($widget.state == 'ready') {\n\t\tvar pag = myScope.paginator;\n\t\tif (pag.current_page < pag.page_number) {\n\t\t\tvar params = getParams();\n\t\t\tparams._px_p = Number(params._px_p) + 1;\n\t\t\treturn loadNextPage(params);\n\t\t} else {\n\t\t\tloadMoreLink.setProperty('style.display', 'none');\n\t\t\tloadMoreLink.setProperty('href');\n\t\t}\n\t}\n}\n\nfunction init() {\n\t// Clear Collection\n\tpostsWidget.removeChildren();\n\t// Load Items\n\tmyScope = {\n\t\tcollectionBuilder: null,\n\t\tpaginator: null,\n\t\tparams: null\n\t};\n\tloadNextPage(getParams());\n\t// Set on-click action of load-more-link\n\tloadMoreLink.on('click', loadMoreClicked);\n}\n\ninit();\n"},"id":"div-bottom","version":"wb4"}],"on":{},"version":"wb4","id":"div-center"},{"style":{},"type":"import","name":"Import","on":{},"version":"wb4","children":[],"url":"/api/v2/cms/contents/blog-widgets/content#main-footer","id":"import-footer"}],"id":"body","class":"w3-light-grey","modules":[{"title":"W3 CSS","url":"https://www.w3schools.com/w3css/4/w3.css","type":"css","load":"lazy","state":"success"},{"title":"Google API","url":"https://fonts.googleapis.com/css?family=Raleway","type":"css","load":"lazy","state":"success"},{"title":"Persian Font","url":"//cdn.viraweb123.ir/api/v2/cdn/libs/persian-free-fonts@0.1.0/fonts.css","type":"css","load":"lazy","state":"success","error":{"path":"//cdn.viraweb123.ir/api/v2/cdn/libs/persian-free-fonts@0.1.0/fonts.css","message":"fail"}},{"title":"Fontawsome 4.7","url":"https://cdn.viraweb123.ir/api/v2/cdn/libs/Font-Awesome@4.7.0/css/font-awesome.min.css","type":"css","load":"lazy","state":"success"},{"url":"//cdn.viraweb123.ir/api/v2/cdn/libs/modules@0.2.11/dist/collection-builder.min.js","title":"Collection Builder JS","type":"js","load":"before","state":"success"}]}